<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="strict-origin-when-cross-origin">
    <title>Programming Quest - Chapter 1</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            padding: 0; 
            color: #333;
        }

        /* --- GLOBAL GAMING BACKGROUND --- */
        .gaming-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10;
            background: linear-gradient(135deg, #1a2a6c 0%, #b21f1f 100%, #fdbb2d 100%);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            overflow: hidden;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Floating Shapes */
        .shape {
            position: absolute;
            filter: blur(50px);
            opacity: 0.6;
            animation: floatShape 20s infinite linear;
            z-index: -9;
        }
        .shape:nth-child(1) {
            top: -10%; left: -10%; width: 500px; height: 500px;
            background: #667eea; border-radius: 50%;
            animation-duration: 25s;
        }
        .shape:nth-child(2) {
            bottom: -10%; right: -10%; width: 400px; height: 400px;
            background: #764ba2; border-radius: 50%;
            animation-duration: 30s;
            animation-direction: reverse;
        }
        .shape:nth-child(3) {
            top: 30%; left: 40%; width: 300px; height: 300px;
            background: #ff416c; border-radius: 50%;
            animation-duration: 20s;
        }

        @keyframes floatShape {
            0% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(100px, 100px) rotate(180deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        /* Grid Overlay */
        .grid-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
            linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 30px 30px;
            z-index: -8;
            pointer-events: none;
        }

        /* Glassmorphism Container Style */
        .glass-container {
            width: 95%;
            max-width: 1200px;
            background: rgba(255, 255, 255, 0.92); 
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            overflow: hidden;
            position: relative;
            min-height: 80vh;
            margin: 40px 20px;
            display: none; 
            animation: fadeIn 0.5s ease-in;
        }

        /* --- SPLASH PAGE --- */
        .homepage {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: transparent; 
            z-index: 9999;
            color: white;
            text-align: center;
        }

        .homepage-content {
            position: relative;
            z-index: 2;
            width: 100%;
            max-width: 800px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(10px);
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .logo {
            font-size: 8em;
            margin-bottom: 20px;
            text-shadow: 0 10px 20px rgba(0,0,0,0.5);
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        .start-btn {
            background: white;
            color: #667eea;
            border: none;
            padding: 20px 60px;
            border-radius: 50px;
            font-size: 1.5em;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            margin-top: 40px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .start-btn:hover {
            transform: scale(1.1) translateY(-5px);
            box-shadow: 0 20px 50px rgba(255, 255, 255, 0.4);
            background: #f8f9fa;
        }

        /* --- LOADING SCREEN --- */
        .loading-screen {
            display: none;
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(10px);
            color: white;
            z-index: 9000;
        }
        .loading-screen.active { display: flex; }

        .loading-bar {
            width: 300px;
            height: 15px;
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            overflow: hidden;
            margin-top: 20px;
        }

        .loading-progress {
            height: 100%;
            background: #fff;
            width: 0%;
            border-radius: 10px;
            transition: width 0.1s linear;
            box-shadow: 0 0 15px rgba(255,255,255,0.8);
        }

        /* --- INTRO PAGE --- */
        .intro-content {
            padding: 60px;
            text-align: center;
        }
        
        .intro-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
            text-align: left;
        }

        .intro-card {
            background: rgba(255,255,255,0.5);
            padding: 30px;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }

        .intro-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.5em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .intro-card ul {
            list-style-type: none;
            padding: 0;
        }

        .intro-card li {
            margin-bottom: 10px;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
        }

        .intro-card li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
        }

        .name-input {
            padding: 15px 20px;
            font-size: 1.2em;
            border: 2px solid #667eea;
            border-radius: 50px;
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
            text-align: center;
            outline: none;
            transition: all 0.3s;
            background: rgba(255, 255, 255, 0.9);
        }
        
        .name-input:focus {
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
            border-color: #764ba2;
        }

        /* --- VIDEO TEMPLATE STYLES --- */
        .video-wrapper {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 30px auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
            background: #000;
            aspect-ratio: 16/9; 
            cursor: pointer;
            border: 4px solid #fff;
        }

        .video-thumbnail {
            position: absolute;
            top: 0; left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #2c3e50, #4ca1af); 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: transform 0.4s ease;
        }

        .video-wrapper:hover .video-thumbnail { transform: scale(1.05); opacity: 0.8; }

        .play-button {
            width: 80px; height: 80px;
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(5px);
            border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            border: 3px solid white;
            transition: all 0.3s ease;
        }

        .play-icon {
            width: 0; height: 0; 
            border-top: 15px solid transparent;
            border-bottom: 15px solid transparent;
            border-left: 25px solid white;
            margin-left: 5px; 
        }

        .video-wrapper:hover .play-button {
            background: #ff4757; border-color: #ff4757;
            transform: scale(1.1);
        }

        .video-iframe {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            border: none; display: none; z-index: 10;
            object-fit: cover; 
        }
        
        .video-wrapper.is-playing .video-iframe { display: block; }
        .video-wrapper.is-playing .video-thumbnail { display: none; }

        /* --- HEADER & STATS --- */
        .header {
            background: white;
            color: #333;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .stats-bar {
            background: #f8f9fa;
            padding: 15px;
            display: flex;
            justify-content: center;
            gap: 40px;
            border-bottom: 3px solid #667eea;
        }

        .stat-value { font-size: 1.8em; font-weight: bold; color: #667eea; }
        .stat-label { font-size: 0.9em; color: #666; text-transform: uppercase; }

        .content {
            padding: 40px;
            min-height: 500px;
            background: transparent; 
        }

        /* --- MODULE MENU --- */
        .main-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .menu-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            cursor: pointer;
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .menu-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 40px rgba(102, 126, 234, 0.4);
        }

        .menu-card.locked {
            background: #e0e0e0;
            color: #888;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            border: 1px solid #ccc;
        }
        .menu-card.locked:hover { transform: none; }

        .final-quiz-card {
            background: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%) !important;
            box-shadow: 0 10px 30px rgba(255, 65, 108, 0.4);
        }
        .final-quiz-card:hover { box-shadow: 0 20px 50px rgba(255, 65, 108, 0.6); }

        /* --- QUIZ STYLES --- */
        .option-btn {
            background: white;
            border: 2px solid #e9ecef;
            padding: 20px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1.1em;
            text-align: left;
            width: 100%;
            margin-bottom: 10px;
        }

        .option-btn:hover { background: #f8f9fa; border-color: #667eea; padding-left: 25px; }
        .option-btn.selected { background: #e7eaff; border-color: #667eea; color: #667eea; font-weight: bold; }
        .option-btn.correct { background: #d4edda; border-color: #28a745; color: #155724; }
        .option-btn.incorrect { background: #f8d7da; border-color: #dc3545; color: #721c24; }

        .module-section {
            background: #fff;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            border-left: 5px solid #667eea;
        }

        .module-section h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.6em;
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }

        .module-section h4 {
            color: #333;
            margin-top: 25px;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .module-section p, .module-section ul, .module-section li {
            line-height: 1.8;
            color: #495057;
            font-size: 1.05em;
        }

        .module-section ul {
            margin-left: 25px;
            margin-bottom: 15px;
        }

        .info-box { background: #d1ecf1; border-left: 5px solid #17a2b8; padding: 20px; margin: 25px 0; border-radius: 5px; font-size: 1.05em; }
        .highlight-box { background: #fff3cd; border-left: 5px solid #ffc107; padding: 20px; margin: 25px 0; border-radius: 5px; font-size: 1.05em; }
        .animation-box { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); padding: 30px; border-radius: 15px; margin: 20px 0; text-align: center; }
        .computer-animation { font-size: 5em; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

        .fade-in { animation: fadeIn 0.5s forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        .back-btn-quiz {
            background: transparent;
            border: none;
            color: #666;
            font-size: 1em;
            cursor: pointer;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .back-btn-quiz:hover { color: #dc3545; }

        /* --- CERTIFICATE STYLES --- */
        .certificate-container {
            border: 10px solid #667eea;
            padding: 40px;
            border-radius: 20px;
            background: #fff url('https://www.transparenttextures.com/patterns/cream-paper.png');
            position: relative;
            text-align: center;
            margin: 20px auto;
            max-width: 800px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.1);
        }

        .certificate-border {
            border: 2px solid #333;
            padding: 30px;
            position: relative;
        }

        .cert-header {
            font-family: 'Times New Roman', serif;
            font-size: 3em;
            color: #667eea;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .cert-subheader {
            font-size: 1.5em;
            color: #555;
            margin-bottom: 30px;
        }

        .cert-name {
            font-family: 'Great Vibes', cursive;
            font-size: 4em;
            color: #333;
            border-bottom: 2px solid #ccc;
            display: inline-block;
            padding: 0 40px 10px;
            margin: 20px 0;
            font-style: italic;
        }

        .cert-body {
            font-size: 1.2em;
            margin: 30px 0;
            line-height: 1.6;
            color: #444;
        }

        .cert-footer {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            padding: 0 50px;
        }

        .cert-signature {
            border-top: 1px solid #333;
            padding-top: 10px;
            width: 200px;
        }

        

        @media (max-width: 768px) {
            .stats-bar { flex-direction: column; gap: 15px; }
            .content { padding: 20px; }
            .homepage h1 { font-size: 2.5em; }
            .intro-grid { grid-template-columns: 1fr; }
            .cert-header { font-size: 2em; }
            .cert-name { font-size: 2.5em; }
            .cert-footer { flex-direction: column; gap: 30px; align-items: center; }
        }
    </style>
</head>
<body>

    <!-- ANIMATED GAMING BACKGROUND -->
    <div class="gaming-background">
        <div class="grid-overlay"></div>
        <div class="shape"></div>
        <div class="shape"></div>
        <div class="shape"></div>
    </div>

    <!-- HOMEPAGE (SPLASH PAGE) -->
    <div class="homepage" id="homepage">
        <div class="homepage-content">
            <div class="logo">üéÆ</div>
            <h1>Programming Quest</h1>
            <p>Chapter 1: Introduction to Computer & Programming</p>
            <div style="width: 100px; height: 4px; background: rgba(255,255,255,0.5); margin: 20px auto; border-radius: 2px;"></div>
            <p style="font-size: 1em; opacity: 0.8; letter-spacing: 1px;">CSC536 MULTIMEDIA INSTRUCTIONAL DESIGN</p>
            <button class="start-btn" onclick="startGame()">Start Adventure üöÄ</button>
        </div>
    </div>

    <!-- LOADING SCREEN -->
    <div class="loading-screen" id="loadingScreen">
        <div style="font-size: 4em; animation: bounce 1s infinite;">‚öôÔ∏è</div>
        <div class="loading-text" style="font-size: 1.5em; margin-top: 20px;">Initializing World...</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
        <div class="loading-percentage" id="loadingPercentage">0%</div>
    </div>

    <!-- INTRO PAGE -->
    <div class="glass-container" id="introContainer">
        <div class="intro-content">
            <h1 style="color: #667eea; font-size: 2.5em; margin-bottom: 10px;">Chapter 1: Overview</h1>
            <p style="font-size: 1.2em; color: #555;">Introduction to Computer System & Programming</p>
            
            <div class="intro-grid">
                <div class="intro-card">
                    <h3>üéØ Objectives</h3>
                    <ul>
                        <li>Understand basic computer operations (IPOS).</li>
                        <li>Differentiate between Hardware and Software.</li>
                        <li>Learn the Program Development Life Cycle (PDLC).</li>
                        <li>Explore different generations of programming languages.</li>
                        <li>Write and interpret simple code logic.</li>
                    </ul>
                </div>
                <div class="intro-card">
                    <h3>üèÜ Learning Outcomes</h3>
                    <ul>
                        <li>Define a computer and its core components.</li>
                        <li>Classify system software vs application software.</li>
                        <li>Identify key steps in solving programming problems.</li>
                        <li>Compare compilers and interpreters.</li>
                        <li>Execute a basic "Hello World" program.</li>
                    </ul>
                </div>
            </div>

            <div style="margin: 20px 0;">
                <input type="text" id="playerNameInput" class="name-input" placeholder="Enter your name for certificate..." />

            <p id="nameError" style="color:red; font-weight:bold; display:none; margin-top:10px;">
             ‚ö†Ô∏è Please enter your name first!
            </p>

            </div>

            <button class="start-btn" onclick="startFromIntro()" style="margin-top: 0;">Continue to Pre-Assessment ‚û°Ô∏è</button>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div class="glass-container" id="appContainer">
        <!-- HEADER -->
        <div class="header">
            <h2 style="color: #667eea; margin: 0;">üéÆ Programming Quest</h2>
        </div>

        <!-- STATS BAR -->
        <div class="stats-bar">
            <div class="stat-item">
                <span class="stat-value" id="totalScore">0</span>
                <span class="stat-label">Total Score</span>
            </div>
            <div class="stat-item">
                <span class="stat-value" id="modulesCompleted">0/5</span>
                <span class="stat-label">Modules</span>
            </div>
            
        </div>

        <!-- MAIN CONTENT AREA -->
        <div class="content" id="mainContent"></div>
    </div>

    <script>
        // --- GAME DATA ---
        let gameState = {
  playerName: "Pelajar Cemerlang",
  totalScore: 0,
  modulesCompleted: {},
  currentQuiz: null,
  quizAnswers: {},
  preQuizCompleted: false,

  // NEW: store best scores
  bestScores: {
    modules: {},   // e.g. {1: 40, 2: 50}
    final: 0       // best final score
  }
};


        // --- UPDATED VIDEO PLAYER FUNCTION (SUPPORT LOCAL & YOUTUBE) ---
        function getVideoTemplate(title, videoUrl) {
            return `
            <div class="video-wrapper" onclick="playVideo(this, '${videoUrl}')">
                <div class="video-thumbnail">
                    <div class="play-button"><div class="play-icon"></div></div>
                    <div class="video-label">üé• ${title}</div>
                    <div style="margin-top:10px; opacity:0.7; font-size:0.9em;">Click to Watch</div>
                </div>
            </div>`;
        }

    

        const preQuizQuestions = [
            { question: "What does CPU stand for?", options: ["Central Processing Unit", "Computer Personal Unit", "Central Program Utility", "Computer Processing Utility"], correct: 0 },
            { question: "Which is an example of hardware?", options: ["Windows", "Keyboard", "Microsoft Word", "Python"], correct: 1 },
            { question: "What is software?", options: ["Physical parts of computer", "Computer games only", "Programs and instructions", "Internet connection"], correct: 2 },
            { question: "Which is a programming language?", options: ["Windows", "Microsoft", "Google", "Python"], correct: 3 },
            { question: "What is the first step in programming?", options: ["Writing code", "Understanding the problem", "Testing", "Debugging"], correct: 1 }
        ];

        // --- MODULES DATA WITH YOUTUBE LINKS ---
        const modules = {
            1: {
                title: "Computer Basics",
                content: `
                    <div class="animation-box"><div class="computer-animation">üíª</div><h2>Understanding Computer Systems</h2></div>
                    
                    <!-- YouTube Link Module 1 -->
                    ${getVideoTemplate("Introduction to Computers", "https://www.youtube.com/embed/HB4I2CgkcCo?autoplay=1")}
                    
                    <div class="module-section">
                        <h3>üìö Definition & Core Concept</h3>
                        <p>A <strong>computer</strong> is an electronic device operating under the control of instructions stored in its own memory. It can accept data (input), process the data according to specified rules (process), produce results (output), and store the results for future use (storage).</p>
                        
                        <h4>Data vs Information</h4>
                        <ul>
                            <li><strong>Data:</strong> Collection of raw unprocessed facts, figures, and symbols (e.g., "32", "Ali").</li>
                            <li><strong>Information:</strong> Data that is organized, meaningful, and useful (e.g., "Ali is 32 years old").</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üîÑ The Information Processing Cycle (IPOS)</h3>
                        <p>Every computer performs four basic operations known as the IPOS cycle:</p>
                        <ul>
                            <li><strong>Input:</strong> Entering data and instructions into the computer (via Keyboard, Mouse, Microphone).</li>
                            <li><strong>Process:</strong> Performing arithmetic and logical operations on data (via CPU).</li>
                            <li><strong>Output:</strong> Conveying information to one or more people (via Monitor, Printer, Speakers).</li>
                            <li><strong>Storage:</strong> Holding data, instructions, and information for future use (via Hard Drive, SSD, Cloud).</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üéØ Why are Computers Powerful?</h3>
                        <ul>
                            <li><strong>Speed:</strong> Process billions of instructions per second (measured in GHz).</li>
                            <li><strong>Reliability:</strong> Electronic components rarely break or fail compared to mechanical parts.</li>
                            <li><strong>Accuracy:</strong> If the input is correct, the output will be consistently correct (GIGO Principle - Garbage In, Garbage Out).</li>
                            <li><strong>Consistency:</strong> Computers can perform the same task repeatedly without error or fatigue.</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>üí° Advanced Insight:</strong> Modern computers use the <strong>Von Neumann Architecture</strong>, where both data and programs are stored in the same memory space!
                    </div>
                `,
                quiz: [
                    { 
                        question: "Which of the following best describes the difference between Data and Information?", 
                        options: ["Data is processed facts; Information is raw figures.", "Data is raw unprocessed facts; Information is processed and meaningful data.", "There is no difference; they are synonyms.", "Data is for humans; Information is for computers."], 
                        correct: 1 
                    },
                    { 
                        question: "In the IPOS cycle, where does the actual manipulation of data occur?", 
                        options: ["In the Storage unit (SSD/HDD).", "In the Output device (Monitor).", "In the Central Processing Unit (CPU).", "In the Input device (Keyboard)."], 
                        correct: 2 
                    },
                    { 
                        question: "What does the 'GIGO' principle stand for regarding computer accuracy?", 
                        options: ["Get In, Get Out", "Good Input, Good Output", "Garbage In, Garbage Out", "General Input, General Output"], 
                        correct: 2 
                    },
                    { 
                        question: "Which unit describes the processing speed of a modern computer CPU?", 
                        options: ["Gigabytes (GB)", "Gigahertz (GHz)", "Pixels per inch (PPI)", "Megabits per second (Mbps)"], 
                        correct: 1 
                    },
                    { 
                        question: "The Von Neumann Architecture is characterized by which feature?", 
                        options: ["Having separate memory for data and instructions.", "Storing both data and program instructions in the same memory.", "Using only mechanical gears for processing.", "Requiring human intervention for every calculation step."], 
                        correct: 1 
                    }
                ]
            },
            2: {
                title: "Hardware & Software",
                content: `
                    <div class="animation-box"><div class="computer-animation">üîß</div><h2>Hardware vs Software Architecture</h2></div>
                    
                    <!-- YouTube Link Module 2 -->
                    ${getVideoTemplate("Hardware Explained", "https://www.youtube.com/embed/1d-1Ei4D7mo?autoplay=1")}
                    
                    <div class="module-section">
                        <h3>üñ•Ô∏è Hardware Architecture</h3>
                        <p><strong>Hardware</strong> refers to the tangible, physical components of a computer system. It is categorized into:</p>
                        <ul>
                            <li><strong>System Unit:</strong> The case containing electronic components used to process data (Motherboard, CPU, RAM).</li>
                            <li><strong>Input Devices:</strong> Hardware used to enter data (Keyboard, Mouse, Scanner, Webcam).</li>
                            <li><strong>Output Devices:</strong> Hardware that conveys information (Monitor, Printer, Projector).</li>
                            <li><strong>Storage Devices:</strong> Records and retrieves items to/from storage media (SSD, Flash Drive).</li>
                            <li><strong>Communications Devices:</strong> Enables computer to send/receive data (Modem, Network Card).</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üíø Software Classifications</h3>
                        <p><strong>Software</strong> consists of series of instructions that tell the hardware how to perform tasks. It is divided into two main categories:</p>
                        
                        <h4>1. System Software</h4>
                        <p>Programs that control or maintain the operations of the computer and its devices. Examples:</p>
                        <ul>
                            <li><strong>Operating System (OS):</strong> Coordinates all activities among hardware (e.g., Windows 11, macOS, Linux).</li>
                            <li><strong>Utility Programs:</strong> Maintenance tasks like virus scanning, disk cleanup, and file compression.</li>
                        </ul>

                        <h4>2. Application Software</h4>
                        <p>Programs designed to make users more productive or assist with personal tasks. Examples:</p>
                        <ul>
                            <li><strong>Web Browser:</strong> Chrome, Edge.</li>
                            <li><strong>Word Processing:</strong> Microsoft Word.</li>
                            <li><strong>Spreadsheet:</strong> Microsoft Excel.</li>
                        </ul>
                    </div>

                    <div class="highlight-box">
                        <strong>üìñ Critical Distinction:</strong> You interact with Application Software, which interacts with System Software, which then controls the Hardware!
                    </div>
                `,
                quiz: [
                    { question: "Which of the following is NOT considered a System Software?", options: ["Microsoft Windows 11", "Linux Ubuntu", "Microsoft Word", "Norton Antivirus Utility"], correct: 2 },
                    { question: "What is the primary role of the Operating System (OS)?", options: ["To browse the internet efficiently.", "To create documents and spreadsheets.", "To coordinate activities among computer hardware resources.", "To permanently store data even without power."], correct: 2 },
                    { question: "Which hardware component is primarily responsible for temporary data storage while the computer is running?", options: ["Hard Disk Drive (HDD)", "Random Access Memory (RAM)", "Central Processing Unit (CPU)", "Read-Only Memory (ROM)"], correct: 1 },
                    { question: "A modem or network card falls under which hardware category?", options: ["Input Devices", "Output Devices", "Communications Devices", "Storage Devices"], correct: 2 },
                    { question: "Which statement best describes the relationship between Hardware and Software?", options: ["Software allows hardware to physically change shape.", "Hardware provides the instructions for software to execute.", "Hardware performs the physical tasks directed by the software instructions.", "There is no direct relationship between them."], correct: 2 }
                ]
            },
            3: {
                title: "Programming Basics",
                content: `
                    <div class="animation-box"><div class="computer-animation">üìù</div><h2>The Art of Programming</h2></div>
                    
                    <!-- YouTube Link Module 3 -->
                    ${getVideoTemplate("What is Programming?", "https://www.youtube.com/embed/taO7nfcoCT0?autoplay=1")}
                    
                    <div class="module-section">
                        <h3>üéØ Program Development Life Cycle (PDLC)</h3>
                        <p>Programming is not just writing code. It follows a structured cycle:</p>
                        <ol>
                            <li><strong>Analyze:</strong> Define the problem, inputs, outputs, and logical requirements.</li>
                            <li><strong>Design:</strong> Plan the solution logic using tools like Flowcharts or Pseudocode.</li>
                            <li><strong>Code:</strong> Write the actual program instructions in a programming language.</li>
                            <li><strong>Test & Debug:</strong> Run the program to find and fix syntax or logic errors.</li>
                            <li><strong>Maintain:</strong> Update and modify the program after it has been deployed.</li>
                        </ol>
                    </div>

                    <div class="module-section">
                        <h3>üß© Algorithms & Logic Design</h3>
                        <p>An <strong>Algorithm</strong> is a step-by-step procedure to solve a problem.</p>
                        <ul>
                            <li><strong>Pseudocode:</strong> Writing the logic in English-like statements (e.g., "IF student score > 50 THEN print Pass").</li>
                            <li><strong>Flowchart:</strong> A visual representation using symbols (Diamonds for decisions, Rectangles for processes).</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üêû Types of Errors</h3>
                        <ul>
                            <li><strong>Syntax Error:</strong> Violating the grammar rules of the language (e.g., missing a semicolon). The program won't run.</li>
                            <li><strong>Logic Error:</strong> The program runs but produces incorrect results (e.g., using addition instead of multiplication).</li>
                            <li><strong>Runtime Error:</strong> Occurs during execution, causing a crash (e.g., dividing by zero).</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>üí° Pro Tip:</strong> Spending more time in the <strong>Analysis and Design</strong> phase drastically reduces time spent on Debugging later!
                    </div>
                `,
                quiz: [
                    { question: "Which step of the PDLC involves planning the logic using flowcharts or pseudocode?", options: ["Analysis Phase", "Coding Phase", "Design Phase", "Testing Phase"], correct: 2 },
                    { question: "If a program runs successfully but calculates the wrong total price, what type of error is this?", options: ["Syntax Error", "Logic Error", "Runtime Error", "Hardware Error"], correct: 1 },
                    { question: "What is Pseudocode in the context of programming?", options: ["A machine language code that the CPU executes directly.", "A graphical representation using shapes and arrows.", "An informal high-level description of the programming logic.", "A specific code used only for hacking."], correct: 2 },
                    { question: "Which symbol in a flowchart typically represents a Decision (Yes/No)?", options: ["Rectangle", "Circle", "Diamond", "Parallelogram"], correct: 2 },
                    { question: "Why is the Maintenance phase important in the PDLC?", options: ["To write the code for the first time.", "To ensure the program adapts to changing needs and remains bug-free over time.", "To design the flowchart of the program.", "To compile the source code into machine code."], correct: 1 }
                ]
            },
            4: {
                title: "Languages & Tools",
                content: `
                    <div class="animation-box"><div class="computer-animation">‚öôÔ∏è</div><h2>Languages & Translation</h2></div>
                    
                    <!-- YouTube Link Module 4 -->
                    ${getVideoTemplate("Languages Overview", "https://www.youtube.com/embed/EGQh5SZctaE?autoplay=1")}
                    
                    <div class="module-section">
                        <h3>üåê Hierarchy of Programming Languages</h3>
                        
                        <h4>1. Low-Level Languages (Machine Oriented)</h4>
                        <ul>
                            <li><strong>Machine Language (1GL):</strong> The only language the computer directly understands. Uses binary (0s and 1s). Very difficult for humans.</li>
                            <li><strong>Assembly Language (2GL):</strong> Uses mnemonics (symbolic codes) like 'ADD' or 'MOV'. Needs an <em>Assembler</em> to translate.</li>
                        </ul>
                        
                        <h4>2. High-Level Languages (Human Oriented)</h4>
                        <ul>
                            <li><strong>Procedural (3GL):</strong> Uses English-like instructions (C, Basic, Pascal).</li>
                            <li><strong>Object-Oriented (OOP):</strong> Focuses on objects and data (Java, C++, Python).</li>
                            <li><strong>Natural Language (5GL):</strong> Uses visual tools or natural conversation (AI prompts).</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üõ†Ô∏è Translators: Compiler vs Interpreter</h3>
                        <p>High-level code (Source Code) must be translated into Machine Code (Object Code).</p>
                        <ul>
                            <li><strong>Compiler:</strong> Translates the <em>entire</em> program at once. Creates an executable file. Faster execution, but debugging can be harder. (e.g., C++).</li>
                            <li><strong>Interpreter:</strong> Translates and executes the program <em>line-by-line</em>. No executable file created. Slower execution, but easier to debug. (e.g., Python).</li>
                        </ul>
                    </div>

                    <div class="info-box">
                        <strong>üí° IDE (Integrated Development Environment):</strong> A software suite that combines a Text Editor, Compiler/Interpreter, and Debugger into one interface (e.g., Visual Studio Code).
                    </div>
                `,
                quiz: [
                    { question: "What is the key difference between a Compiler and an Interpreter?", options: ["A compiler translates line-by-line; an interpreter translates all at once.", "A compiler translates the entire code at once creating an executable; an interpreter translates line-by-line.", "A compiler is used for web pages; an interpreter is for hardware.", "There is no difference; they are the same tool."], correct: 1 },
                    { question: "Which generation of programming language consists of 0s and 1s and is directly understood by the CPU?", options: ["Assembly Language (2GL)", "High-Level Language (3GL)", "Machine Language (1GL)", "Natural Language (5GL)"], correct: 2 },
                    { question: "What tool is required to convert Assembly Language code into Machine Language?", options: ["Compiler", "Interpreter", "Assembler", "Debugger"], correct: 2 },
                    { question: "Which of the following is an example of an Object-Oriented Programming language?", options: ["Assembly", "Machine Code", "Java", "HTML"], correct: 2 },
                    { question: "What is the primary function of an IDE (Integrated Development Environment)?", options: ["To simply type text like Notepad.", "To combine coding, debugging, and compiling tools in one interface.", "To browse the internet.", "To design graphics for games."], correct: 1 }
                ]
            },
            5: {
                title: "Getting Started",
                content: `
                    <div class="animation-box"><div class="computer-animation">üöÄ</div><h2>Core Programming Concepts</h2></div>
                    
                    <!-- YouTube Link Module 5 -->
                    ${getVideoTemplate("First Program (Python)", "https://www.youtube.com/embed/KOdfpbnWLVo?autoplay=1")}
                    
                    <div class="module-section">
                        <h3>üì¶ Variables & Data Types</h3>
                        <p><strong>Variable:</strong> A named storage location in memory whose value can change during execution.</p>
                        <p><strong>Data Types:</strong> Defines the type of data a variable can hold.</p>
                        <ul>
                            <li><strong>Integer (int):</strong> Whole numbers (e.g., 10, -5).</li>
                            <li><strong>Float/Double:</strong> Decimal numbers (e.g., 3.14, 99.9).</li>
                            <li><strong>String:</strong> Sequence of characters (e.g., "Hello World").</li>
                            <li><strong>Boolean:</strong> Logical values (True or False).</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üßÆ Operators</h3>
                        <ul>
                            <li><strong>Arithmetic:</strong> +, -, *, /, % (Modulus/Remainder).</li>
                            <li><strong>Relational (Comparison):</strong> == (Equal), != (Not Equal), > (Greater), < (Less).</li>
                            <li><strong>Logical:</strong> AND (&&), OR (||), NOT (!). Used to combine conditions.</li>
                        </ul>
                    </div>

                    <div class="module-section">
                        <h3>üö¶ Control Structures</h3>
                        <p>Control structures dictate the flow of the program:</p>
                        <ol>
                            <li><strong>Sequence:</strong> Instructions are executed one after another in order.</li>
                            <li><strong>Selection (Decision):</strong> Executes code based on a condition (If-Else).</li>
                            <li><strong>Repetition (Looping):</strong> Repeats code while a condition is true (For Loop, While Loop).</li>
                        </ol>
                    </div>

                    <div class="highlight-box">
                        <strong>üí™ Practice Challenge:</strong> Try to write a program that asks for a user's age and prints "Adult" if age > 18, else prints "Minor". This uses Variables, Integers, and Selection!
                    </div>
                `,
                quiz: [
                    { question: "If `x = 5` and `y = 10`, what is the result of the logical condition `(x > 0) AND (y < 5)`?", options: ["True, because x is greater than 0.", "False, because although x > 0, y is not less than 5.", "True, because at least one condition is correct.", "Error, you cannot compare numbers."], correct: 1 },
                    { question: "Which control structure allows a program to execute a block of code repeatedly?", options: ["Sequence", "Selection", "Repetition (Looping)", "Declaration"], correct: 2 },
                    { question: "What is the purpose of the Modulus operator (%) in programming?", options: ["To calculate percentage.", "To divide two numbers.", "To find the remainder of a division.", "To multiply two numbers."], correct: 2 },
                    { question: "Which data type would be best suited to store a user's name?", options: ["Integer", "Boolean", "Float", "String"], correct: 3 },
                    { question: "In the statement `if (age >= 18)`, which type of operator is `>=`?", options: ["Arithmetic Operator", "Relational (Comparison) Operator", "Logical Operator", "Assignment Operator"], correct: 1 }
                ]
            }
        };

        const finalQuizQuestions = [
            { question: "What translates high-level code to machine code?", options: ["Compiler", "Printer", "Monitor", "Mouse"], correct: 0 },
            { question: "Which memory loses data when power is off?", options: ["HDD", "ROM", "RAM", "Flash Drive"], correct: 2 },
            { question: "Correct order of programming?", options: ["Code > Test", "Analyze > Design > Code > Test", "Debug > Code", "Test > Design"], correct: 1 },
            { question: "Which is a high-level language?", options: ["Binary", "Assembly", "Python", "Machine Code"], correct: 2 },
            { question: "A variable is...", options: ["A storage container", "A type of screen", "A fast computer", "A virus"], correct: 0 }
        ];

        // --- GAME FUNCTIONS ---

        function startGame() {
            document.getElementById('homepage').style.display = 'none';
            const loadingScreen = document.getElementById('loadingScreen');
            loadingScreen.classList.add('active');
            
            let progress = 0;
            const loadingInterval = setInterval(() => {
                progress += 2;
                document.getElementById('loadingProgress').style.width = progress + '%';
                document.getElementById('loadingPercentage').textContent = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    setTimeout(() => {
                        loadingScreen.classList.remove('active');
                        // Tunjuk Intro Page dulu (Bukan terus masuk game)
                        document.getElementById('introContainer').style.display = 'block';
                    }, 500);
                }
            }, 20);
        }

        // Fungsi baru untuk bergerak dari Intro Page ke Pre-Assessment
        function startFromIntro() {
         const nameInput = document.getElementById('playerNameInput');
         const errorMsg = document.getElementById('nameError');

    // If empty name
     if (!nameInput || nameInput.value.trim() === "") {
         errorMsg.style.display = "block"; // show error
         nameInput.style.borderColor = "red";
         nameInput.focus();
        return; // STOP here, cannot proceed
    }

    // If valid name
    errorMsg.style.display = "none";
    nameInput.style.borderColor = "#667eea";

    gameState.playerName = nameInput.value.trim();

    document.getElementById('introContainer').style.display = 'none';
    document.getElementById('appContainer').style.display = 'block';
    startPreAssessment();
    }

        function playVideo(element, videoUrl) {
    // prevent duplicates
    element.innerHTML = "";

    element.classList.add("is-playing");

    if (videoUrl.includes("youtube.com") || videoUrl.includes("youtu.be")) {
        const iframe = document.createElement("iframe");
        iframe.src = videoUrl;
        iframe.allowFullscreen = true;
        iframe.frameBorder = "0";
        iframe.allow = "autoplay; encrypted-media";
        iframe.referrerPolicy = "strict-origin-when-cross-origin";
        iframe.className = "video-iframe";
        element.appendChild(iframe);
    } else {
        const video = document.createElement("video");
        video.src = videoUrl;
        video.controls = true;
        video.autoplay = true;
        video.className = "video-iframe";
        element.appendChild(video);
    }
}


        function startPreAssessment() {
            gameState.currentQuiz = {
                type: 'pre',
                questions: preQuizQuestions,
                currentQuestion: 0,
                score: 0,
                answers: []
            };
            showQuizQuestion();
        }

        function showQuizQuestion() {
            const quiz = gameState.currentQuiz;
            const question = quiz.questions[quiz.currentQuestion];
            const progress = ((quiz.currentQuestion + 1) / quiz.questions.length) * 100;

            
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="fade-in">
                    <button class="back-btn-quiz" onclick="exitQuizConfirm()">
                        <i class="fas fa-arrow-left"></i> Exit Quiz
                    </button>

                    <h2 style="color: #667eea; margin-bottom: 20px; text-align: center;">
                        ${quiz.type === 'pre' ? 'üéØ Pre-Assessment' : 
                          quiz.type === 'final' ? 'üéì Final Assessment' : 
                          `üìù Module ${quiz.moduleNum} Quiz`}
                    </h2>
                    <div style="width: 100%; height: 10px; background: #eee; border-radius: 5px; margin-bottom: 30px;">
                        <div style="width: ${progress}%; height: 100%; background: #667eea; border-radius: 5px; transition: width 0.3s;"></div>
                    </div>
                    
                    <div class="module-section">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                            <span style="font-weight: bold; color: #667eea;">Question ${quiz.currentQuestion + 1}/${quiz.questions.length}</span>
                        </div>
                        
                        <div style="font-size: 1.3em; margin-bottom: 25px;">${question.question}</div>
                        
                        <div id="optionsGrid">
                            ${question.options.map((option, index) => `
                                <button class="option-btn" onclick="selectAnswer(${index})">
                                    ${String.fromCharCode(65 + index)}. ${option}
                                </button>
                            `).join('')}
                        </div>
                        
                        <button id="submitBtn" onclick="submitAnswer()" disabled
                            style="background: #667eea; color: white; border: none; padding: 15px 40px; border-radius: 30px; font-size: 1.1em; cursor: pointer; margin-top: 20px; opacity: 0.5;">
                            Submit Answer
                        </button>
                    </div>
                </div>
            `;
        }

        function exitQuizConfirm() {
    if (confirm("Are you sure you want to exit? Your quiz progress will be lost.")) {
        if (gameState.currentQuiz.type === 'pre') {
            alert("You must complete the Pre-Assessment!");
        } else if (gameState.currentQuiz.type === 'module') {
            showModule(gameState.currentQuiz.moduleNum);
        } else {
            showMainMenu();
        }
    }
}


        function selectAnswer(optionIndex) {
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.classList.remove('selected'));
            buttons[optionIndex].classList.add('selected');
            
            gameState.quizAnswers.selected = optionIndex;
            const btn = document.getElementById('submitBtn');
            btn.disabled = false;
            btn.style.opacity = '1';
        }

        function submitAnswer() {
            const quiz = gameState.currentQuiz;
            const question = quiz.questions[quiz.currentQuestion];
            const selectedAnswer = gameState.quizAnswers.selected;
            
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach((btn, index) => {
                btn.disabled = true;
                if (index === question.correct) btn.classList.add('correct');
                else if (index === selectedAnswer && index !== question.correct) btn.classList.add('incorrect');
            });
            
            if (selectedAnswer === question.correct) {
  quiz.score += 10; // only update quiz score here
}

            
            quiz.answers.push(selectedAnswer);
            
            const btn = document.getElementById('submitBtn');
            btn.textContent = quiz.currentQuestion < quiz.questions.length - 1 ? 'Next Question ‚Üí' : 'View Results üéâ';
            btn.onclick = nextQuestion;
        }

        function nextQuestion() {
            const quiz = gameState.currentQuiz;
            quiz.currentQuestion++;
            if (quiz.currentQuestion < quiz.questions.length) {
                gameState.quizAnswers = {};
                showQuizQuestion();
            } else {
                showQuizResults();
            }
        }

        function showQuizResults() {
    const quiz = gameState.currentQuiz;
    const percentage = (quiz.score / (quiz.questions.length * 10)) * 100;
    const passed = percentage >= 60; // 60% Passing mark logic

    // ============================
    // ‚úÖ STEP 3 HERE (LIMITER LOGIC)
    // ============================

    // If module quiz: add only improvement
    if (quiz.type === "module") {
        const moduleNum = quiz.moduleNum;
        const prevBest = gameState.bestScores.modules[moduleNum] || 0;

        if (quiz.score > prevBest) {
            const delta = quiz.score - prevBest;
            gameState.totalScore += delta;
            gameState.bestScores.modules[moduleNum] = quiz.score;
        }
    }

    // If final quiz: add only improvement
    if (quiz.type === "final") {
        const prevFinalBest = gameState.bestScores.final || 0;

        if (quiz.score > prevFinalBest) {
            const delta = quiz.score - prevFinalBest;
            gameState.totalScore += delta;
            gameState.bestScores.final = quiz.score;
        }
    }

    // ============================
    // ‚úÖ END OF LIMITER LOGIC
    // ============================


    if (quiz.type === 'pre') {
        gameState.preQuizCompleted = true;
        document.getElementById('mainContent').innerHTML = `
            <div class="score-display fade-in" style="text-align: center; padding: 40px; background: linear-gradient(135deg, #667eea, #764ba2); color: white; border-radius: 20px;">
                <h2>Pre-Assessment Done!</h2>
                <div style="font-size: 4em; font-weight: bold; margin: 20px 0;">${percentage}%</div>
                <button class="start-btn" onclick="enterMainGame()">Enter Modules üìö</button>
            </div>`;
    }

    else if (quiz.type === 'final') {
        updateStats();

        if (passed) {
            showCertificate(percentage);
        } else {
            document.getElementById('mainContent').innerHTML = `
                <div class="module-section fade-in" style="text-align: center;">
                    <h2>Sorry, Try again! üí™</h2>
                    <div style="font-size: 3em; color: #dc3545; margin: 20px 0;">${percentage}%</div>
                    <p>You need at least 60% to receive the certificate.</p>
                    <div style="margin-top: 30px;">
                        <button onclick="showMainMenu()" style="background: #6c757d; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; margin-right: 10px;">Main Menu</button>
                        <button onclick="startFinalQuiz()" style="background: #667eea; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer;">Retry Final</button>
                    </div>
                </div>`;
        }
    }

    else {
        if (passed) gameState.modulesCompleted[quiz.moduleNum] = true;

        updateStats();

        let resultMessage = passed
            ? "Kudos! You may proceed to the next module."
            : "Please try again to proceed to the next module.";

        document.getElementById('mainContent').innerHTML = `
            <div class="module-section fade-in" style="text-align: center;">
                <h2>${passed ? "PASS! üéâ" : "Try again üí™"}</h2>
                <div style="font-size: 3em; color: ${passed ? '#28a745' : '#dc3545'}; margin: 20px 0;">${percentage}%</div>
                <p>${resultMessage}</p>
                <div style="margin-top: 30px;">
                    <button onclick="showMainMenu()" style="background: #6c757d; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; margin-right: 10px;">Main Menu</button>
                    <button onclick="showModule(${quiz.moduleNum})" style="background: #667eea; color: white; border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer;">Retake</button>
                </div>
            </div>`;
    }
}


        function showCertificate(score) {
            const today = new Date().toLocaleDateString();
            const content = document.getElementById('mainContent');
            
            content.innerHTML = `
                <div class="fade-in">
                    <h2 style="text-align:center; color:#28a745; margin-bottom:20px;">üéâ Congrats! Every modules has been completed! üéâ</h2>
                    
                    <div class="certificate-container">
  <div class="certificate-border">
    <div class="cert-header">Certificate of Achievement</div>
    <div class="cert-subheader">Awarded to</div>

    <div class="cert-name">${gameState.playerName}</div>

    <div class="cert-body">
      For successfully completing<br>
      <strong>Programming Quest: Chapter 1</strong><br>
      With an Excellent Score: <strong>${score}%</strong>
    </div>
  </div>
</div>

                            
                            
                            
                            <div class="cert-footer">
                                <div class="cert-signature">
                                    <p>Tarikh: ${today}</p>
                                </div>
                                <div class="cert-signature" style="font-family: 'Great Vibes', cursive;">
                                    Programming Quest
                                    <p style="font-family: 'Segoe UI', sans-serif; font-size: 0.8em; margin-top:5px;">Pengajar</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="window.print()" style="background: #28a745; color: white; border: none; padding: 15px 40px; border-radius: 30px; font-size: 1.1em; cursor: pointer; margin-right: 10px;">
                            <i class="fas fa-print"></i> Print Certificate
                        </button>
                        <button onclick="showMainMenu()" style="background: #6c757d; color: white; border: none; padding: 15px 40px; border-radius: 30px; font-size: 1.1em; cursor: pointer;">
                            Main Menu
                        </button>
                    </div>
                </div>
            `;
        }

        function enterMainGame() {
            updateStats();
            showMainMenu();
        }

        function updateStats() {
            document.getElementById('totalScore').textContent = gameState.totalScore;
            const completed = Object.keys(gameState.modulesCompleted).length;
            document.getElementById('modulesCompleted').textContent = `${completed}/5`;
        }

        function showModule(moduleNum) {
            const module = modules[moduleNum];
            gameState.currentModule = moduleNum;
            
            const content = document.getElementById('mainContent');
            content.innerHTML = `
                <div class="fade-in">
                    <button onclick="showMainMenu()" style="background: transparent; border: 2px solid #667eea; color: #667eea; padding: 8px 20px; border-radius: 20px; cursor: pointer; margin-bottom: 20px; font-weight: bold;">‚Üê Back to Menu</button>
                    <h1 style="color: #667eea; margin-bottom: 20px;">${module.title}</h1>
                    ${module.content}
                    <div style="text-align: center; margin-top: 40px;">
                        <button onclick="startModuleQuiz(${moduleNum})" 
                            style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 20px 50px; border-radius: 50px; font-size: 1.3em; cursor: pointer; box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4); transition: transform 0.2s;">
                            Start Quiz üéØ
                        </button>
                    </div>
                </div>
            `;
        }

        function startModuleQuiz(moduleNum) {
            const module = modules[moduleNum];
            gameState.currentQuiz = {
                type: 'module',
                moduleNum: moduleNum,
                questions: module.quiz,
                currentQuestion: 0,
                score: 0,
                answers: []
            };
            showQuizQuestion();
        }

        function startFinalQuiz() {
            if (Object.keys(gameState.modulesCompleted).length < 5) {
                alert('üîí Please complete all 5 modules first!');
                return;
            }
            gameState.currentQuiz = {
                type: 'final',
                questions: finalQuizQuestions,
                currentQuestion: 0,
                score: 0,
                answers: []
            };
            showQuizQuestion();
        }

        function showMainMenu() {
            const content = document.getElementById('mainContent');
            
            let menuHTML = `<h2 style="color: #667eea; text-align: center; margin-bottom: 30px;">Choose your path üó∫Ô∏è</h2><div class="main-menu fade-in">`;
            
            [1,2,3,4,5].forEach(num => {
                const isLocked = num > 1 && !gameState.modulesCompleted[num - 1];
                const isCompleted = gameState.modulesCompleted[num];
                
                if (isLocked) {
                    menuHTML += `
                        <div class="menu-card locked" onclick="alert('üîí Please complete Module ${num-1}!')">
                            <div style="font-size: 3em; margin-bottom: 10px;">üîí</div>
                            <h3>Module ${num}</h3>
                            <p>Locked</p>
                        </div>
                    `;
                } else {
                    menuHTML += `
                        <div class="menu-card" onclick="showModule(${num})">
                            <div style="font-size: 3em; margin-bottom: 10px;">
                                ${num==1?'üíª':num==2?'üîß':num==3?'üìù':num==4?'‚öôÔ∏è':'üöÄ'}
                            </div>
                            <h3>Module ${num}</h3>
                            <p>${modules[num].title}</p>
                            ${isCompleted ? '<div style="margin-top:10px; font-weight:bold; color: #a3ffac;">‚úÖ Completed </div>' : ''}
                        </div>
                    `;
                }
            });

            const allModulesDone = Object.keys(gameState.modulesCompleted).length >= 5;
            
            menuHTML += `
                <div class="menu-card final-quiz-card" 
                    ${allModulesDone ? `onclick="startFinalQuiz()"` : `onclick="alert('üîí Complete all modules to unlock Final Assessment!')"`} 
                    style="${!allModulesDone ? 'opacity: 0.7; cursor: not-allowed;' : ''}">
                    <div style="font-size: 3em; margin-bottom: 10px;">üéì</div>
                    <h3>Final Assessment</h3>
                    <p>${allModulesDone ? 'Click to Start!' : 'Locked üîí (Complete the modules)'}</p>
                </div>
            </div>`;

            content.innerHTML = menuHTML;
        }

        document.getElementById("playerNameInput").addEventListener("input", function () {
    const errorMsg = document.getElementById("nameError");
    if (this.value.trim() !== "") {
        errorMsg.style.display = "none";
        this.style.borderColor = "#667eea";
    }
});
    </script>
</body>
</html>